{"id":"178219","urlID":"3brq1","name":"Commentet javascript code","description":"","content":"\/\/\/ <reference path=\"jquery-1.4.1-vsdoc.js\" \/>\n\/\/\/ <reference path=\"swfobject-vsdoc.js\" \/>\nvar isScrolling = false;\nTimeVal = 0;\nDiaperCount = 0;\nvar TimeInterval = setInterval(CallTimerInc, 1000);\nvar timestamp;\nvar msg_count = 0;\n\nfunction child_height() {\n    var cw_height = 0;\n    $('.child_wrapper').removeAttr(\"style\");\n    $('.child_wrapper').each(function () {\n        cw_height = cw_height > $(this).height() ? cw_height : $(this).height();\n    });\n    $('.child_wrapper').height(cw_height);   \n}\n\nfunction CallTimerInc() {\n\tTimeVal++;\n}\n\nfunction update_child_sleep_count() {\n    $(\"#sleep_counter span\").text($(\".child img.chid_img.sleep\").length);\n}\n\n$(window).load(function () {\n    child_height();\n\n    $(\".note\").each(function (index) {\n    \tvar childId = $(this).attr(\"data-id\");\n    \tvar antMsg = $(this).find(\".hidden_msg_count\").attr(\"data-id\");\n    \tmsg_count = msg_count + parseInt(antMsg);\n    });\n\n    var department = $(\"body\").data(\"department-id\");\n    setInterval(function () { ajaxCallDepartment(\"hasmessagedepartment\", department, msg_count); }, 60000);\n});\n\n$(document).ready(function () {\n    bootbox.setDefaults({\n        locale: \"no\"\n    });\n\n    update_child_sleep_count();\n\n\tvar isIOS = ((\/iphone|ipad\/gi).test(navigator.appVersion));\n\tvar myDown = isIOS ? \"touchend\" : \"mousedown\";\n\tvar myUp = isIOS ? \"touchend\" : \"mouseup\";\n\tTimeVal = 0;\n\ttimestamp = $(\"#timestamp\").val();\n\t\/\/setInterval(function () { hasnewactivity(); }, 10000);\n\t\n\t$(document).on(myDown, \".remove_diaper\", function () {\n\t    var diaperline = $(this).parent();\n\t    var diaperid = diaperline.attr(\"data-diaper-id\");\n\t    var diapertype = diaperline.attr(\"data-diaper-type\");\n\t    var childid = diaperline.parent().attr(\"data-child-id\");\n\t\tbootbox.confirm(\"Vil du slette bleien registrert \" + $(this).parent().text() + \"?\", function (result) {\n\t        if (result) {\n\t            $.post(\"ajax.aspx\", { method: \"deltediaper\", diaperid: diaperid, connectionid: connectionid }, function (data) {\n\t                $(\"span[data-diaper-id=\" + diaperid + \"]\").remove();\n\t                var dcount = 0;\n\t                if (diapertype == 1) {\n\t                    dcount = $(\"#quick_diaper_yellow\" + childid + \" a img\").data(\"count\") - 1;\n\t                    $(\"#quick_diaper_yellow\" + childid + \" a img\").data(\"count\",dcount)\n\t                    $(\"#quick_diaper_yellow\" + childid + \" a img\").attr(\"data-count\", dcount);\n\t                    $(\"#quick_diaper_yellow\" + childid + \" a span\").text(dcount);\n\t                } else {\n\t                    dcount = $(\"#quick_diaper_brown\" + childid + \" a img\").data(\"count\") - 1;\n\t                    $(\"#quick_diaper_brown\" + childid + \" a img\").data(\"count\", dcount);\n\t                    $(\"#quick_diaper_brown\" + childid + \" a img\").attr(\"data-count\", dcount);\n\t                    $(\"#quick_diaper_brown\" + childid + \" a span\").text(dcount);\n\t                }\n\t                console.log(dcount);\n\t                \n\t                $(\"#child\" + childid + \" .actions_big .diaper\" + diapertype + \" img\").data(\"count\", dcount);\n\t                $(\"#child\" + childid + \" .actions_big .diaper\" + diapertype + \" img\").attr(\"data-count\", dcount);\n\t                $(\"#child\" + childid + \" .actions_big .diaper\" + diapertype + \" span\").text(dcount);\n\t                \n\t                DiaperCount--;\n\t            });\n\t        }\n\t    });\n\n\t});\n\n\t$(document).bind('mousemove click mouseup mousedown keydown keypress keyup submit change scroll resize dblclick touchstart touchend touchmove', function (event) {\n\t\tTimeVal = 0;\n\t});\n\n\t$(document).bind('touchmove', function (event) {\n\t\tisScrolling = true;\n\t});\n\n\t$(document).bind('touchstart', function (event) {\n\t\tisScrolling = false;\n\t});\n\n    $(window).resize(function () {\n        child_height();\n    });\n\n\n    $('a:not([target])').on(myDown, function () {\n    \tif ($(this).attr('href') != undefined) {\n    \t\tself.location = $(this).attr('href');\n    \t}\n        return false;\n    });\n\n    var childcount = $(\"#counter .arrived\").text();\n    $('.pluss').on(myDown, function () {\n        \n    \tif (!isScrolling) {\n    \t\tif (!$(this).next().hasClass(\"childcount\")) {\n    \t\t\tid = $(this).next().attr(\"data-id\");\n\n    \t\t\tif ($('#child' + id).is(':visible')) {\n    \t\t\t\t$('#child' + id).hide();\n    \t\t\t\t$(this).parent().removeClass(\"selected\");\n    \t\t\t\t$(this).removeClass(\"active\");\n    \t\t\t\t$('.popup_arrow').removeClass(\"active\");\n    \t\t\t\t$(\"#overlay\").hide();\n    \t\t\t\tconsole.log('dialog is closed');\n\n    \t\t\t\tif (refresh)\n    \t\t\t\t    window.location.reload(true);\n\n    \t\t\t\tdialogopen = false;\n    \t\t\t}\n    \t\t\telse {\n    \t\t\t    \n    \t\t\t\t$('.popup').hide();\n    \t\t\t\t$('#child' + id).show();\n\n    \t\t\t\tdialogopen = true;\n    \t\t\t\tconsole.log('dialog is open');\n\n    \t\t\t\t$(this).parent().addClass(\"selected\");\n    \t\t\t\t$(this).addClass(\"active\");\n    \t\t\t\t$(\"#overlay\").show();\n    \t\t\t\t$('#child' + id).css(\"top\", 0);\n    \t\t\t\tvar childbgheight = $('#child' + id).height() + 20;\n    \t\t\t\tvar etopheight = $('#child' + id).offset().top + childbgheight;\n    \t\t\t\tvar windowheigt = $(window).height() + $(window).scrollTop();\n    \t\t\t\tif (etopheight > windowheigt) {\n    \t\t\t\t\tvar etop = windowheigt - etopheight;\n    \t\t\t\t\t\/\/console.log(etop);\n    \t\t\t\t\t\/\/if (((etop*-1) \/ childbgheight) > 0.2) {\n    \t\t\t\t\t\/\/    if ($('#child' + id + ' img.popup_bg').attr(\"src\") == \"\/images\/popup_bg2.png\") {\n    \t\t\t\t\t\/\/        console.log($('#child' + id + ' img.popup_bg').attr(\"src\"));\n    \t\t\t\t\t\/\/        $('#child' + id + ' img.popup_bg').attr(\"src\", \"\/images\/popup_bg4.png\");\n    \t\t\t\t\t\/\/    } else {\n    \t\t\t\t\t\/\/        $('#child' + id + ' img.popup_bg').attr(\"src\", \"\/images\/popup_bg3.png\");\n    \t\t\t\t\t\/\/    }\n    \t\t\t\t\t\/\/}\n    \t\t\t\t\t$('#child' + id).css(\"top\", etop);\n    \t\t\t\t}\n    \t\t\t\t\/\/console.log($('#child' + id).css(\"width\"));\n    \t\t\t\tif ($('#child' + id).position().left < 0) {\n    \t\t\t\t\tvar el_left = $('#child' + id).parent().offset().left - $('#child' + id).parent().width() * 0.15;\n    \t\t\t\t\tvar el_top = $('#child' + id).parent().offset().top + ($('#child' + id).parent().height() \/ 4);\n    \t\t\t\t\t$('.popup_arrow').removeClass(\"right\");\n    \t\t\t\t\t$('.popup_arrow').addClass(\"active\");\n    \t\t\t\t\t$('.popup_arrow').css('left', el_left);\n    \t\t\t\t\t$('.popup_arrow').css('top', el_top);\n    \t\t\t\t\t$('.popup_arrow').css('width', $('#child' + id).parent().width() * 0.15);\n    \t\t\t\t\t$('.popup_arrow').css('height', $('#child' + id).parent().height() * 0.24);\n    \t\t\t\t}\n    \t\t\t\telse {\n    \t\t\t\t\tvar el_left = $('#child' + id).parent().offset().left + $('#child' + id).parent().width();\n    \t\t\t\t\tvar el_top = $('#child' + id).parent().offset().top + ($('#child' + id).parent().height() \/ 4);\n    \t\t\t\t\t$('.popup_arrow').addClass(\"right\");\n    \t\t\t\t\t$('.popup_arrow').addClass(\"active\");\n    \t\t\t\t\t$('.popup_arrow').css('left', el_left);\n    \t\t\t\t\t$('.popup_arrow').css('top', el_top);\n    \t\t\t\t\t$('.popup_arrow').css('width', $('#child' + id).parent().width() * 0.15);\n    \t\t\t\t\t$('.popup_arrow').css('height', $('#child' + id).parent().height() * 0.24);\n    \t\t\t\t}\n    \t\t\t\t\/\/debugger;\n    \t\t\t}\n    \t\t}\n    \t}\n    });\n\n    $('.newnote').on(myDown, function () {\n    \tif (!$(this).next().hasClass(\"childcount\")) {\n    \t\tid = $(this).next().attr(\"data-id\");\n    \t\tif ($('#int_msg_child' + id).is(':visible')) {\n    \t\t\t$('#int_msg_child' + id).hide();\n    \t\t\t$(this).parent().removeClass(\"selected\");\n    \t\t\t$(\"#overlay\").hide();\n    \t\t}\n    \t\telse {\n    \t\t\t$('.note').hide();\n    \t\t\t$('#int_msg_child' + id).show();\n    \t\t\t$(this).parent().addClass(\"selected\");\n    \t\t\t$(\"#overlay\").show();\n    \t\t\tvar childbgheight = $('#int_msg_child' + id + ' img.note_bg').height()\n    \t\t\tvar etopheight = $('#int_msg_child' + id).offset().top + childbgheight;\n    \t\t\tvar windowheigt = $(window).height() + $(window).scrollTop();\n    \t\t\tif (etopheight > windowheigt) {\n    \t\t\t\tvar etop = windowheigt - etopheight;\n    \t\t\t\t$('#int_msg_child' + id).css(\"top\", etop);\n    \t\t\t}\n    \t\t}\n    \t}\n    });\n\n    $('.child').on(myDown, function () {\n    \tif (!isScrolling) {\n    \t\tif (!$(this).parent().hasClass(\"selected\") && !$(this).hasClass(\"diaperchange\")) {\n    \t\t\tif ($(this).hasClass(\"childcount\")) {\n    \t\t\t\tif ($(this).hasClass(\"ishere\")) {\n    \t\t\t\t\tif ($(this).hasClass(\"counted\")) {\n    \t\t\t\t\t\talert(\"Barnet er allerede telt\");\n    \t\t\t\t\t} else {\n    \t\t\t\t\t\tchildcount--;\n    \t\t\t\t\t\t$(\"#counter span.count\").text(childcount);\n    \t\t\t\t\t\t$(this).addClass(\"counted\");\n    \t\t\t\t\t}\n\n    \t\t\t\t} else {\n    \t\t\t\t\talert(\"Kan ikke telle barn som ikke har kommet\");\n    \t\t\t\t}\n    \t\t\t} else {\n    \t\t\t\tif ($(this).prev().hasClass(\"sleep\")) {\n    \t\t\t\t\talert(\"Barn kan ikke forlate n\u00e5r det sover!\");\n    \t\t\t\t} else {\n    \t\t\t\t\tid = $(this).attr(\"data-id\");\n    \t\t\t\t\tif ($(this).hasClass(\"ishere\")) {\n    \t\t\t\t\t\tajaxCall(\"went\", id);\n    \t\t\t\t\t} else {\n    \t\t\t\t\t\tajaxCall(\"came\", id);\n    \t\t\t\t\t}\n    \t\t\t\t\tvar dataoldsort = $(this).closest(\".child_wrapper\").attr(\"data-sort-diaper\");\n    \t\t\t\t\tvar datanewsort = $(this).closest(\".child_wrapper\").attr(\"data-not-sort-diaper\");\n    \t\t\t\t\t$(this).closest(\".child_wrapper\").attr(\"data-sort-diaper\", datanewsort);\n    \t\t\t\t\t$(this).closest(\".child_wrapper\").attr(\"data-not-sort-diaper\", dataoldsort);\n    \t\t\t\t\t$('#counter').find('.arrived').text($('.child.ishere').length);\n    \t\t\t\t}\n    \t\t\t}\n    \t\t} else {\n    \t\t\t$(this).next().hide();\n    \t\t\t$(\"#overlay\").hide();\n    \t\t\t$(this).parent().removeClass(\"selected\");\n    \t\t}\n    \t}\n    });\n\n    $('.asleep, .awake, .diaper1, .diaper2').on(myDown, function () {\n        var run = true;\n        if ($(this).parent().hasClass(\"actions_big\") && !$(this).parent().hasClass(\"ishere\")) {\n            alert(\"Barnet har ikke kommet!\");\n            run = false;\n        }\n        if (run) {\n            var cid = $(this).parent().parent().attr(\"data-id\");\n            var method = $(this).attr(\"class\").replace(\"diaper \", \"\");\n            \n            var returndata=ajaxCall(method, cid);\n            var d_obj = $(this).find(\"img\");\n            if (method == \"diaper1\" || method == \"diaper2\") {\n                \/\/alert(returndata.message);\n                var d_count = d_obj.data(\"count\") + 1;\n                d_obj.data(\"count\", d_count);\n                d_obj.attr(\"data-count\", d_count);\n\n                if (method == \"diaper1\") {\n                \tvar q_obj = $('#quick_diaper_yellow' + cid).find('a img')\n                \tq_obj.data(\"count\", d_count);\n                \tq_obj.attr(\"data-count\", d_count);\n                }\n                else {\n                \tvar q_obj = $('#quick_diaper_brown' + cid).find('a img')\n                \tq_obj.data(\"count\", d_count);\n                \tq_obj.attr(\"data-count\", d_count);\n                }\n\n                console.log(d_count);\n                var type = \"diaper_yellow\";\n                if (method == \"diaper2\") type = \"diaper_brown\";\n                \n                UpdateDiaperText(cid, method, d_count, $(this), returndata.message);\n            }\n\n            var child_pluss = $(this).parent().parent().parent().find(\".pluss\");\n            var child_countdown = $(this).parent().parent().parent().find(\".child_countdown\");\n            \n            if (method == \"awake\") {\n                if (returndata.type == 2)\n                    window.location.reload(true);\n                  \n            \t$(this).parent().parent().parent().find('.child_bg').attr(\"src\", \"\/images\/child_bg.png\")\n            \t$(this).parent().parent().parent().find('.chid_img').removeClass(\"sleep\");\n            \t$(this).parent().parent().parent().find('.child_bg_sleep').removeClass(\"sleep\");\n\n                d_obj.attr(\"src\", \"\/images\/start_sov.png\");\n                \/\/child_pluss.find(\"img\").attr(\"src\", \"\/images\/pluss.png\");\n                child_pluss.attr(\"class\", \"pluss wake\");\n                $(this).addClass(\"asleep\");\n                $(this).removeClass(\"awake\");\n\n                var now = new Date();\n                var text = pad(now.getHours()) + \":\" + pad(now.getMinutes());\n                $('#popup_sleep_' + cid).find('.tmp_sleep').append(text);\n                $('#popup_sleep_' + cid).find('.tmp_sleep').removeClass(\"tmp_sleep\");\n\n                RemoveCountdown(child_countdown.find('.child_countdown_display').attr('id'));\n            }\n            if (method == \"asleep\") {\n                if (returndata != null) {\n                    if (returndata.type == 2)\n                        window.location.reload(true);\n\n                    $(this).parent().parent().parent().find('.child_bg').attr(\"src\", \"\/images\/child_bg_sleep.png\")\n                    $(this).parent().parent().parent().find('.chid_img').addClass(\"sleep\");\n                    $(this).parent().parent().parent().find('.child_bg_sleep').addClass(\"sleep\");\n\n                    d_obj.attr(\"src\", \"\/images\/stopp_sov.png\");\n                    \/\/child_pluss.find(\"img\").attr(\"src\", \"\/images\/pluss_sleep.png\");\n                    child_pluss.attr(\"class\", \"pluss sleep\");\n                    $(this).addClass(\"awake\");\n                    $(this).removeClass(\"asleep\");\n\n                    var now = new Date();\n                    var text = \"<span class=\\\"tmp_sleep\\\">\" + pad(now.getHours()) + \":\" + pad(now.getMinutes()) + \" - <\/span><br \/>\";\n                    $('#popup_sleep_' + cid).prepend(text);\n\n                    ShowCountdown(child_countdown.find('.child_countdown_display').attr('id'), '', child_countdown.find('.child_countdown_display').attr('data-duration'));\n                }\n            }\n\n            update_child_sleep_count();\n            \n        }\n    });\n\n    function UpdateDiaperText(child_id, method, d_count, el, diaperid) {\n        \n    \tvar big_text = $('#child' + child_id).find(\".\" + method).find(\"span\");\n    \tbig_text.html(d_count);\n    \t\n    \tif (method == \"diaper1\") {\n    \t\tvar small_text = $('#quick_diaper_yellow' + child_id).find(\".quick_\" + method).find(\"span\");\n    \t\tsmall_text.html(d_count);\n    \t}\n    \telse {\n    \t\tvar small_text = $('#quick_diaper_brown' + child_id).find(\".quick_\" + method).find(\"span\");\n    \t\tsmall_text.html(d_count);\n    \t}\n    \tvar now = new Date();\n    \tif (method == \"diaper1\") {\n    \t    var text = \"<span data-diaper-id=\\\"\"+diaperid+\"\\\" class=\\\"diaperline\\\"><img src=\\\"images\/diaper_yellow.png\\\" \/> - \" + pad(now.getHours()) + \":\" + pad(now.getMinutes()) + \"  <img src=\\\"\/images\/red_x.png\\\" alt=\\\"Angre bleie\\\" class=\\\"remove_diaper\\\" \/><\/span>\";\n    \t\t$('#DIAPER_LIST_' + child_id).prepend(text);\n    \t\t$('#popup_diaper_' + child_id).prepend(text);\n    \t\t\n    \t\t$('#DIAPER_LIST_' + child_id).find('*[data-diaper-id=\"' + diaperid + '\"]').data(\"diaper-type\", 1);\n    \t\t$('#DIAPER_LIST_' + child_id).find('*[data-diaper-id=\"' + diaperid + '\"]').attr(\"data-diaper-type\", 1);\n    \t\t$('#popup_diaper_' + child_id).find('*[data-diaper-id=\"' + diaperid + '\"]').data(\"diaper-type\", 1);\n    \t\t$('#popup_diaper_' + child_id).find('*[data-diaper-id=\"' + diaperid + '\"]').attr(\"data-diaper-type\", 1);\n    \t}\n    \telse {\n    \t\tvar text = \"<span data-diaper-id=\\\"\" + diaperid + \"\\\" class=\\\"diaperline\\\"><img src=\\\"images\/diaper_brown.png\\\" \/> - \" + pad(now.getHours()) + \":\" + pad(now.getMinutes()) + \"  <img src=\\\"\/images\/red_x.png\\\" alt=\\\"Angre bleie\\\" class=\\\"remove_diaper\\\" \/><\/span>\";\n    \t\t$('#DIAPER_LIST_' + child_id).prepend(text);\n    \t\t$('#popup_diaper_' + child_id).prepend(text);\n\n    \t\t$('#DIAPER_LIST_' + child_id).find('*[data-diaper-id=\"' + diaperid + '\"]').data(\"diaper-type\", 2);\n    \t\t$('#DIAPER_LIST_' + child_id).find('*[data-diaper-id=\"' + diaperid + '\"]').attr(\"data-diaper-type\", 2);\n    \t\t$('#popup_diaper_' + child_id).find('*[data-diaper-id=\"' + diaperid + '\"]').data(\"diaper-type\", 2);\n    \t\t$('#popup_diaper_' + child_id).find('*[data-diaper-id=\"' + diaperid + '\"]').attr(\"data-diaper-type\", 2);\n    \t}\n    \t\n    \tel.closest(\".child_wrapper\").attr(\"data-sort-diaper\", DiaperCount);\n    \tel.closest(\".child_wrapper\").attr(\"data-sort-diaper\", DiaperCount);\n    \tDiaperCount--;\n    \tchild_height();\n    }\n\n    function RegDiaper(el) {\n    \tvar cid = el.parent().attr(\"data-id\");\n    \tvar method = el.attr(\"class\").replace(\"quick_\", \"\");\n    \tvar returndata=ajaxCall(method, cid);\n    \tvar d_obj = el.find(\"img\");\n    \tvar d_count = d_obj.data(\"count\") + 1;\n    \td_obj.data(\"count\", d_count);\n    \td_obj.attr(\"data-count\", d_count);\n\n    \tif (method == \"diaper1\") {\n    \t\tvar q_obj = $('*[data-id=\"' + cid + '\"]').find('.diaper1');\n    \t\tq_obj.data(\"count\", d_count);\n    \t\tq_obj.attr(\"data-count\", d_count);\n    \t}\n    \telse {\n    \t\tvar q_obj = $('*[data-id=\"' + cid + '\"]').find('.diaper2');\n    \t\tq_obj.data(\"count\", d_count);\n    \t\tq_obj.attr(\"data-count\", d_count);\n    \t}\n\n    \tvar type = \"diaper_yellow\";\n    \tif (method == \"diaper2\") type = \"diaper_brown\";\n    \tUpdateDiaperText(cid, method, d_count, el,returndata.message);\n    }\n\n    $('.quick_diaper1, .quick_diaper2').on(myDown, function () {\n    \tif (!isScrolling) {\n    \t\tRegDiaper($(this));\n    \t}\n    });\n\n    $('.needs').on(myDown, function () {\n        var obj = $(this);\n        var cid = obj.parent().parent().attr(\"data-id\");\n        var type = obj.attr('data-type');\n        var dependant = obj.attr('data-dependant');\n        $.post(\"ajax.aspx\", { method: 'needs', childid: cid,type: type ,dependant: dependant  }, function (data) {\n            if (data.type == 1) {\n                alert(data.message);\n            } else {\n                if (dependant == 1) {\n                    obj.find(\"img\").attr(\"src\", \"\/images\/needs\" + type + \".png\");\n                    obj.attr('data-dependant', 0);\n                } else {\n                    obj.find(\"img\").attr(\"src\", \"\/images\/needs\" + type + \"_dependant.png\");\n                    obj.attr('data-dependant', 1);\n                }\n                \/\/console.log(data.message);\n                \/\/location.reload();\n                \/*if (method == \"came\" || method == \"went\" || method==\"camewent\") {\n                    location.reload();\n                } else {\n                    alert(data.message);\n                }*\/\n            }\n        }, \"json\");\n\n    });\n\n    \n    $(\"#counter\").on(myDown, function () {\n        if (!$(this).hasClass(\"noactive\")) {\n            if ($(this).hasClass(\"active\")) {\n\n                if (refresh)\n                    window.location.reload(true);\n\n\n                $(this).removeClass(\"active\");\n                $(this).find(\"img\").attr(\"src\", \"\/images\/counter1.png\");\n                $(\"body\").css(\"background\", \"#47444d\");\n                $(\".pluss\").show();\n                $(\".child_countdown\").removeClass(\"hide\");\n                $(\".newnote\").show();\n                $(\"#diaper_list\").show();\n                $(\"#sleep_counter\").show();\n                $(\".child.ishere.sleep\").css(\"opacity\", \"0.8\");\n                $(\"#logo\").css(\"opacity\", \"1\");\n                $(\"#counter span.arrived\").show();\n                $(\"#counter span.count\").hide();\n                $('#departmentname').css(\"color\", \"#ffffff\");\n                $('#departmentname').css(\"opacity\", \"1\");\n                $('.child').removeClass(\"childcount\");\n                $('.child').removeClass(\"counted\");\n                $(\"#departmentname a\").attr(\"href\", \"\/?logout=1\");\n                $('.chid_img.sleepCnt').addClass(\"sleep\");\n                $('.chid_img.sleep').removeClass(\"sleepCnt\");\n                if (refresh)\n                    window.location.reload(true);\n\n                counteropen = false;\n                \n            } else {\n                childcount = $(\"#counter .arrived\").text();\n                $(this).addClass(\"active\");\n                $(this).find(\"img\").attr(\"src\", \"\/images\/counter2.png\");\n                $(\"body\").css(\"background\", \"#ffc200\");\n                $(\".pluss\").hide();\n                $(\".child_countdown\").addClass(\"hide\");\n                $(\".newnote\").hide();\n                $(\"#diaper_list\").hide();\n                $(\"#sleep_counter\").hide();\n                $(\".child.ishere.sleep\").css(\"opacity\", \"1\");\n                $(\"#logo\").css(\"opacity\", \"0.3\");\n                $(\"#counter span.count\").show();\n                $(\"#counter span.arrived\").hide();\n                $('.child').addClass(\"childcount\");\n                $('#departmentname').css(\"color\", \"#47444d\");\n                $('#departmentname').css(\"opacity\", \"0.3\");\n                $(\"#counter span.count\").text(childcount);\n                $(\"#departmentname a\").removeAttr(\"href\");\n                $('.chid_img.sleep').addClass(\"sleepCnt\");\n                $('.chid_img.sleep').removeClass(\"sleep\");\n                \/\/childcount = 0;\n\n                console.log(\"counteropen\");\n                counteropen = true;\n            }\n        }\n    });\n\n    $(\"#diaper_list\").on(myDown, function () {\n    \tif (!$(this).hasClass(\"noactive\")) {\n    \t    if ($(this).hasClass(\"active\")) {\n    \t        if (refresh)\n    \t            window.location.reload(true);\n\n    \t\t\t$(this).removeClass(\"active\");\n    \t\t\t$(this).find(\"img\").attr(\"src\", \"\/images\/diaper_list1.png\");\n    \t\t\t$(\"body\").css(\"background\", \"#47444d\");\n    \t\t\t$(\".pluss.wake\").show();\n    \t\t\t$(\".pluss.sleep\").show();\n    \t\t\t$(\".child_countdown\").removeClass(\"hide\");\n    \t\t\t$(\".newnote\").show();\n    \t\t\t$(\".newmessage\").show();\n    \t\t\t$(\"#counter\").show();\n    \t\t\t$(\"#sleep_counter\").show();\n    \t\t\t$(\".child.ishere.sleep\").css(\"opacity\", \"0.8\");\n    \t\t\t$(\"#logo\").css(\"opacity\", \"1\");\n    \t\t\t$(\".quick_diapers\").hide();\n    \t\t\t$(\"#counter span.arrived\").show();\n    \t\t\t$(\".todays_diapers\").hide();\n    \t\t\t$('#departmentname').css(\"color\", \"#ffffff\");\n    \t\t\t$('#departmentname').css(\"opacity\", \"1\");\n    \t\t\t$('.child').removeClass(\"diaperchange\");\n    \t\t\t$(\"#departmentname a\").attr(\"href\", \"\/?logout=1\");\n    \t\t\t$('.child_bg_sleep').css(\"top\", \"17%\");\n\n    \t\t\tchild_height();\n    \t\t\tvar $childs = $(\".row\");\n    \t\t\tvar $data = $childs.clone();\n    \t\t\tvar $filteredData = $data.find('.child_wrapper');\n    \t\t\t$filteredData.sort(function (a, b) {\n    \t\t\t\treturn ($(a).data(\"sort-id\") - $(b).data(\"sort-id\")) * -1\n    \t\t\t});\n\n    \t\t\t$childs.quicksand($filteredData, { attribute: 'data-sort-id', duration: 500, easing: 'easeInOutQuint' });\n\n    \t\t\tdiaperopen = false;\n    \t\t} else {\n    \t\t\tchildcount = $(\"#counter .arrived\").text();\n    \t\t\t$(this).addClass(\"active\");\n    \t\t\t$(this).find(\"img\").attr(\"src\", \"\/images\/diaper_list2.png\");\n    \t\t\t$(\"body\").css(\"background\", \"#312C35\");\n    \t\t\t$(\".pluss.wake\").hide();\n    \t\t\t$(\".pluss.sleep\").hide();\n    \t\t\t$(\".child_countdown\").addClass(\"hide\");\n    \t\t\t$(\".newnote\").hide();\n    \t\t\t$(\".newmessage\").hide();\n    \t\t\t$(\"#counter\").hide();\n    \t\t\t$(\"#sleep_counter\").hide();\n    \t\t\t$(\".child.ishere.sleep\").css(\"opacity\", \"1\");\n    \t\t\t$(\"#logo\").css(\"opacity\", \"0.3\");\n    \t\t\t$(\".quick_diapers\").each(function () {\n    \t\t\t    if ($(this).closest(\".child_wrapper\").find(\".child\").hasClass(\"ishere\")) {\n    \t\t\t        $(this).show();\n    \t\t\t    }\n    \t\t\t});\n    \t\t\t\n    \t\t\t\n    \t\t\t$(\".todays_diapers\").show();\n    \t\t\t$(\"#counter span.arrived\").hide();\n    \t\t\t$('.child').addClass(\"diaperchange\");\n    \t\t\t$('#departmentname').css(\"color\", \"#47444d\");\n    \t\t\t$('#departmentname').css(\"opacity\", \"0.3\");\n    \t\t\t$(\"#departmentname a\").removeAttr(\"href\");\n    \t\t\t$('.child_bg_sleep').css(\"top\", \"50%\");\n    \t\t\tchild_height();\n\n    \t\t\tvar $childs = $(\".row\");\n    \t\t\tvar $data = $childs.clone();\n    \t\t\tvar $filteredData = $data.find('.child_wrapper');\n    \t\t\t$filteredData.sort(function (a, b) {\n    \t\t\t\treturn ($(a).data(\"sort-diaper\") - $(b).data(\"sort-diaper\")) * -1\n    \t\t\t});\n    \t\t\t$childs.quicksand($filteredData, { attribute: 'data-sort-diaper', duration: 500, easing: 'easeInOutQuint' });\n\n    \t\t\tconsole.log(\"diaperopen\");\n    \t\t\tdiaperopen = true;\n    \t\t}\n    \t}\n    });\n\n    \/*$(\"body\").click(function (e) {\n        aler\n        if (e.target.className !== \"popup\" || e.target.className !== \"pluss\") {\n            $(\".popup\").hide();\n            $(\".child_wrapper.selected\").removeClass(\"selected\");\n            $(\"#overlay\").hide();\n          }\n    });*\/\n\n\t\/\/$(document).mouseup(function (e) {\n    $(document).on(myDown, function (e) {\n        hidestuff(e);\n    });\n\n    $(\"#messages_list li\").on(myDown, function () {\n        \/\/alert($(this).find(\"input\").val());\n        $(\"#messages_list li.active\").find(\"img\").attr(\"src\", \"\/images\/letter.png\");\n        $(\"#messages_list li.active\").removeClass(\"active\");\n\n        $(\".textarea textarea\").val($(this).find(\"input\").val());\n        $(this).addClass(\"active\");\n        $(this).find(\"img\").attr(\"src\",\"\/images\/letter_active.png\");\n    });\n\n    \/\/$(\"#messageform #message\").val(\"\");\n\n    $(\"#sendform\").on(myDown, function () {\n        var sendmsg = $(\"#message\").val().trim();\n        var maxchar = 320;\n        if ($(this).attr(\"data-msgtype\") == \"bigmsg\") maxchar = 2000;\n        if (sendmsg == \"\") {\n            alert(\"Vennligst skriv inn melding!\");\n        } else if (sendmsg.length > maxchar) {\n            alert(\"Meldingen kan ikke overstige \" + maxchar + \" tegn!\");\n        }\n        else {\n            $(\"#messageform\").submit();\n        }\n    });\n\n    \/*$('.close').click(function () {\n        $(this).parent().hide();\n    });*\/\n\n});\n\n\nfunction hasnewactivity() {\n    \/\/if (timestamp == 0) timestamp = $(\"timestamp\").val();\n    console.log('checking refresh');\n    $.post(\"ajax.aspx\", { method: \"hasnewactivity\", childid: 0, timestamp: timestamp }, function (data) {\n        console.log(data.message);\n        if (data.type == 1) {\n            alert(data.message);\n        } else {\n            if (data.message==\"True\") {\n                console.log(\"Reloading hasnewactivity\");\n                window.location.reload(true);\n            }\n        }\n    }, \"json\");\n\n}\n\nfunction hidestuff(e) {\n    console.log('hiding stuff');\n\n    \/*if (dialogopen && refresh)\n    {\n        location.reload();\n    }\n\n    dialogopen = false;\n    refresh = false;\n*\/\n    var container = $(\".popup\");\n    var pluss = $(\".pluss\");\n    var child = $(\".child\");\n    var modal = $(\".modal-dialog\");\n\n    var note_container = $(\".note\");\n    var show_note = $(\".newnote\");\n\n    if (!((!container.is(e.target) && container.has(e.target).length === 0) && (!pluss.is(e.target) && pluss.has(e.target).length === 0) && (!child.is(e.target) && child.has(e.target).length === 0) && (!modal.is(e.target) && modal.has(e.target).length === 0))) {\n        note_container.hide();\n        console.log('hiding 1');\n        \n    }\n    else if (!((!note_container.is(e.target) && note_container.has(e.target).length === 0) && (!show_note.is(e.target) && show_note.has(e.target).length === 0) && (!child.is(e.target) && child.has(e.target).length === 0) && (!modal.is(e.target) && modal.has(e.target).length === 0))) {\n        container.hide();\n        console.log('hiding 2');\n    }\n    else {\n        console.log('hiding 3');\n        \n        if (refresh)\n            window.location.reload(true);\n\n        dialogopen = false;\n\n    \tcontainer.hide();\n    \tcontainer.parent().removeClass(\"selected\");\n    \t\n    \tnote_container.hide();\n    \tnote_container.parent().removeClass(\"selected\");\n\n    \tpluss.removeClass(\"active\");\n    \t$(\"#overlay\").hide();\n    \t$('.popup_arrow').removeClass(\"active\");\n\t}\n    \n    \/\/if ((!container.is(e.target) && container.has(e.target).length === 0)) {\n    \/\/    if ((!pluss.is(e.target) && pluss.has(e.target).length === 0)) {\n    \/\/        if ((!child.is(e.target) && child.has(e.target).length === 0)) {\n    \/\/            container.hide();\n    \/\/            container.parent().removeClass(\"selected\");\n    \/\/            $(\"#overlay\").hide();\n    \/\/        }\n    \/\/    }\n    \/\/}\n\n    \/\/if ((!note_container.is(e.target) && note_container.has(e.target).length === 0)) {\n    \/\/    if ((!show_note.is(e.target) && show_note.has(e.target).length === 0)) {\n    \/\/        if ((!child.is(e.target) && child.has(e.target).length === 0)) {\n    \/\/            note_container.hide();\n    \/\/            note_container.parent().removeClass(\"selected\");\n    \/\/            $(\"#overlay\").hide();\n    \/\/        }\n    \/\/    }\n    \/\/}\n}\n\nfunction ajaxCallDepartment(method, departmentid, extra) {\n    \/\/console.log(\"Ant beskjedr for \" + childid + \": \" + extra);\n  \/\/  console.log(\"ajaxCallDepartment \" + method + \" Department: \" + departmentid + \" Extra: \" + extra);\n  \/\/  debugger;\n    var returndata = null;\n\n    $.ajax({\n        type: \"POST\",\n        url: \"ajax.aspx\",\n        dataType: \"json\",\n        async: false,\n        data: { method: method, departmentid: departmentid, extra: extra, timestamp : timestamp },\n        success: function (data) {\n            console.log(data);\n            if (data.type == 1) {\n                alert(data.message);\n            } else {\n                if (method == \"hasmessagedepartment\") {\n                    \/\/console.log(childid + \": \" + data.message);\n                    if (data.message != \"0\" && TimeVal > 30) {\n                        \/\/console.log('treff!: ' + childid);\n                        window.location.reload(true);\n                        \/\/console.log(TimeVal);\n                    }\n                }\n                \n                returndata = data;\n            }\n        }\n    });\n\n    return returndata;\n}\n\nfunction ajaxCall(method, childid, extra) {\n    \/\/console.log(\"Ant beskjedr for \" + childid + \": \" + extra);\n    \/\/console.log(\"ajaxCall \" + method + \" Child: \" + childid);\n    \/\/console.log(\"Connectionid: \" + connectionid);\n    \/\/debugger;\n    var returndata = null;\n    $.ajax({\n        type : \"POST\",\n        url: \"ajax.aspx\",\n        dataType: \"json\",\n        async : false,\n        data : { method: method, childid: childid, extra: extra, connectionid: connectionid }, \n        success: function (data) {\n        \n            if (data.type == 1) {\n                alert(data.message);\n            } else {\n            \n                if (method == \"came\") {\n                    \/*$(\"#child\" + childid + \" .message \").html(\"<h2>Registrert<\/h2>\"); \/\/+ data.message + \"<\/h2>\");\n                    $(\"#child\" + childid + \" .message \").show();\n                    $(\"#child\" + childid + \" .actions_big\").hide();\n                    $(\"#child\" + childid + \" .bottom_needs\").hide();\n                    $(\"#child\" + childid).fadeOut(1200, function () {\n                        location.reload();\n                    });*\/\n                    \/\/location.reload();\n                    $(\".child[data-id=\" + childid + \"]\").addClass(\"ishere\");\n                    $(\"#child\"+childid).find(\".actions_big\").addClass(\"ishere\");\n\n                } else if (method == \"went\") {\n                    $(\".child[data-id=\" + childid + \"]\").removeClass(\"ishere\");\n                    $(\"#child\" + childid).find(\".actions_big\").removeClass(\"ishere\");\n                }\n                else if (method == \"hasmessage\") {\n                    \/\/console.log(childid + \": \" + data.message);\n                    if (data.message != \"0\" && TimeVal > 30) {\n                        \/\/console.log('treff!: ' + childid);\n                        window.location.reload(true);\n                        \/\/console.log(TimeVal);\n                    }\n                }\n\n                else if (method == \"hasmessagedepartment\") {\n                    \/\/console.log(childid + \": \" + data.message);\n                    if (data.message != \"0\" && TimeVal > 30) {\n                        \/\/console.log('treff!: ' + childid);\n                        window.location.reload(true);\n                        \/\/console.log(TimeVal);\n                    }\n                }\n                else if (method == \"diaper1\" || method == \"diaper2\") {\n              \n                }\n                else {\n\n                    \/\/alert(data.message);\n                    \/\/return data;\n                    \/\/alert(\"change\");\n                }\n                \n                returndata = data;\n        \t\n                \/\/alert(data.message);\n                \/*$(\"#child\" + childid).html(\"<h2>\" + data.message + \"<\/h2>\");\n                $(\"#child\" + childid).fadeOut(\"slow\",function () {\n                    location.reload();\n                });*\/\n                \/\/console.log(data.message);\n                \/\/location.reload();\n                \/*if (method == \"came\" || method == \"went\" || method==\"camewent\") {\n                    location.reload();\n                } else {\n                    alert(data.message);\n                }*\/\n            }\n        } \n        });\n\n    return returndata;\n}\n\n\/\/calculates where the hotspots are placed\nfunction recalcHotspots() {\n\tvar width = $(\".slide\").width();\n\tvar height = $(\".slide\").height();\n\n\t$(\".hotspot_link\").each(function () {\n\t\t$(this).css({\n\t\t\tleft: translate($(this).attr(\"data-x\"), width) - 10 + \"px\",\n\t\t\ttop: translate($(this).attr(\"data-y\"), width) - 10 + \"px\",\n\t\t\t\/*width: translate($(this).attr(\"data-width\"), width) + \"px\",\n\t\t\theight: translate($(this).attr(\"data-height\"), width) + \"px\",*\/\n\t\t\tpadding: \"10px\"\n\t\t});\n\t});\n}\n\nfunction translate(from, widthOrHeight) {\n\treturn Math.round((from \/ 1000) * widthOrHeight);\n}\n\nfunction setCookie(name, value, expires) {\n    document.cookie = name + \"=\" + escape(value) + \"; path=\/\" + ((expires == null) ? \"\" : \"; expires=\" + expires.toGMTString());\n}\n\nfunction getCookie(name) {\n\n    var dc = document.cookie;\n    var cname = name + \"=\";\n\n    if (dc.length > 0) {\n        begin = dc.indexOf(cname);\n        if (begin != -1) {\n            begin += cname.length;\n            end = dc.indexOf(\";\", begin);\n            if (end == -1) end = dc.length;\n            return unescape(dc.substring(begin, end));\n        }\n    }\n    return null;\n}\n\n\/* fade in loader and redirect *\/\nfunction delayedRedirect(url) {\n    $(\"#supersize_loading\").fadeIn(\"200\", function () { window.location = url });\n}\n\n\n\/\/ disable selecting\n\/\/ $.disableSelection(selector)\njQuery.fn.extend({\n    disableSelection: function () {\n        this.each(function () {\n            this.onselectstart = function () { return false; };\n            this.unselectable = \"on\";\n            jQuery(this).css('-moz-user-select', 'none');\n        });\n    }\n});\n\n\/\/ check if page has visible scrollbar\n\/\/ $.hasScrollbar()\njQuery.fn.hasScrollbar = function () {\n    var scrollHeight = this.get(0).scrollHeight;\n\n    \/\/safari's scrollHeight includes padding\n    if ($.browser.safari)\n        scrollHeight -= parseInt(this.css('padding-top')) + parseInt(this.css('padding-bottom'));\n\n    if (this.height() < scrollHeight)\n        return true;\n    else\n        return false;\n}\n\n\/\/ get width of scrollbar (varies between browsers)\nfunction scrollbarWidth() {\n    var div = $('<div style=\"width:50px;height:50px;overflow:hidden;position:absolute;top:-200px;left:-200px;\"><div style=\"height:100px;\"><\/div>');\n    \/\/ Append our div, do our calculation and then remove it \n    $('body').append(div);\n    var w1 = $('div', div).innerWidth();\n    div.css('overflow-y', 'scroll');\n    var w2 = $('div', div).innerWidth();\n    $(div).remove();\n    return (w1 - w2);\n}\n\nfunction loadScript(url, callback) {\n    var head = document.getElementsByTagName('head')[0];\n    var script = document.createElement('script');\n    script.src = url;\n\n    var done = false;\n    if (callback) {\n        script.onload = script.onreadystatechange = function () {\n            if (!done && (!this.readyState || this.readyState === 'loaded' || this.readyState === 'complete')) {\n                done = true;\n\n                callback();\n\n                \/\/ Handle memory leak in IE\n                script.onload = script.onreadystatechange = null;\n                head.removeChild(script);\n            }\n        };\n    }\n\n    head.appendChild(script);\n}\n\n\nfunction addCss(cssName, cssMedia) {\n    if (!jQuery(\"link[src='\" + cssName + \"']\").length) {\n        (function () {\n\n            var stylesheet = document.createElement('link');\n            stylesheet.href = cssName;\n            stylesheet.rel = 'stylesheet';\n            stylesheet.type = 'text\/css';\n            stylesheet.media = cssMedia;\n            document.getElementsByTagName('head')[0].appendChild(stylesheet);\n\n        })();\n    }\n}\n\nfunction pad(n) { return (\"0\" + n).slice(-2); }","weightedVote":"2.5","numVotes":"0","author":"","community":"1","dateAdded":"2015-09-24","pattern":"\/(\\\/\\*[^*]*\\*\\\/|\/\/.+)\/g","replace":"","state":"{\"substEnabled\":true}"}